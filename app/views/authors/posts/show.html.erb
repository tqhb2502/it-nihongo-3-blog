<%= link_to 'Back', root_path, class: 'btn btn-dark mb-3' %>

<div class='card mb-5'>
  <div class='card-header text-right'>
    <h6 class='card-title m-0 d-flex justify-content-between'>
      <div>
        <b>Author:</b> <%= @post.author.name %> (<%= @post.author.email %>)
      </div>
      <div>
        <b>Published</b> <%= time_ago_in_words(@post.published_at) %> ago
      </div>
    </h6>
  </div>
  <div class='card-body'>
    <% @post.elements.order(position: :asc).each do |element| %>
      <% if element.persisted? %>
        <% if element.paragraph? %>
          <% if element.content.present? %>
            <div class='mt-3 p-3 displayed-paragraph'>
              <div class='paragraph-content'>
                <%= element.content %>
              </div>
            </div>
          <% end %>
        <% elsif element.image? %>
          <% if element.image.present? %>
            <div class='mt-3 p-3 image'>
              <%= image_tag(element.image) %>
            </div>
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  </div>
</div>

<div class='card mb-5'>
  <div class='card-header'>
    <h6 class='mb-0'><b>Comments</b></h6>
  </div>
  <div class='card-body'>
    <%= form_with(model: [@post, @comment]) do |form| %>
      <%= form.hidden_field :author_id, value: current_author.id %>
      <%= form.hidden_field :post_id, value: @post.id %>
      <%= form.text_area :content, class: 'form-control mb-2' %>
      <%= form.submit 'Submit', class: 'btn btn-primary mb-4' %>
    <% end %>
    <% @post.comments.each do |comment| %>
      <% if comment.persisted? %>
        <div class='card mb-3'>
          <div class='card-header bg-dark'>
            <h6 class='mb-0 text-light'><%= comment.author.name %> (<%= comment.author.email %>)</h6>
          </div>
          <div class='card-body comment-content'>
            <%= simple_format(comment.content) %>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>
</div>
